# Nax CTF Walkthrough (2023)

![nax_room_banner](https://github.com/CSpanias/pentesting.io/blob/main/thm/nax/media/nax_banner.png)

The [Nax room](https://tryhackme.com/room/nax) is the second **medium rated difficulty** room of the Starter Series ([**Dogcat**](https://github.com/CSpanias/pentesting.io/blob/main/thm/dogcat/dogcat.md) was the first). 

Working through this felt like a game of [Cluedo](https://en.wikipedia.org/wiki/Cluedo), in a sense that it did not require much pentest tooling usage, but mostly searching constantly for clues. Having said that, I did enjoy working on this room, as I learned a lot of new things such as the **Nagios XI** monitoring tool, some **chemistry**, and the abstract artist **Piet Mondrian**.

With the exception of Nagios XI, doesn't sound a lot like a THM CTF challenge, does it?

  <img src="https://github.com/CSpanias/pentesting.io/blob/main/thm/nax/media/piet_artist.png"
    width=60%
   height=60% />

Reading the room's description:

>_Identify the critical **security flaw in the most powerful and trusted network monitoring software on the market**, that allows an user authenticated execute **remote code execution**._

and pairing that with the room's note saying that it requires _Metasploit 6_, we can safely assume that we will need to **find a Nagios XI exploit on Metasploit that allows us to perform RCE**. 

That sounds like a pretty straightforward thing to do, but believe me when I say that it's not!

## Background Info

### Nagios XI

I encountered **Nagios XI** for the first time, and as a result, I did a bit of reading about it. It seems that [Nagios XI](https://www.edureka.co/blog/nagios-tutorial/) is a tool used mostly in DevOps for continous monitoring of systems, applications, etc. 

In brief, I think of it as a boosted [crontab](https://man7.org/linux/man-pages/man5/crontab.5.html): it periodically runs scripts which can be reached from a command line or a GUI. When something goes wrong, it will generate an alert in the form of an email or SMS, which helps developers start working on the issue right away, before it has any negative impact on the business productivity.

<img src="https://github.com/CSpanias/pentesting.io/blob/main/thm/nax/media/Nagios-Working-nagios-Tutorial-Edureka-3.png"
  width=80%
  height=80% />

### The Piet Programming Language

Quoting from [DangerMouse.net](https://www.dangermouse.net/esoteric/piet.html):
>_**Piet** is a programming language in which programs look like abstract paintings. The language is named after **Piet Mondrian**, who pioneered the field of **geometric abstract art**._

Although it would have been nice, we don't have to make any kind of abstract paining ourselves for this room, just to make some basic usage of the Piet language.

Armed with the knowledge of what Nagios XI is, Piet's programming language existence, and the fact that we probably need to find an exploit within Metasploit to perform RCE, we are ready to crack on üèÉ !

## CTF Process

### 1. Enumeration with nmap, nikto, and gobuster

As always, we can start with an **nmap port-scan**:

<img src="(https://github.com/CSpanias/pentesting.io/blob/main/thm/nax/media/nmap-scan.png)"
  width=80%
  height=80% />

There is a web server at port 80, so let's start with visiting it through our browser:

<img src="(https://github.com/CSpanias/pentesting.io/blob/main/thm/nax/media/homepage.png)"
  width=80%
  height=80% />
